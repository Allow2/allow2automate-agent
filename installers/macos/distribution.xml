<?xml version="1.0" encoding="utf-8"?>
<installer-gui-script minSpecVersion="2">
    <title>Allow2 Automate Agent</title>
    <organization>com.allow2</organization>
    <domains enable_localSystem="true"/>
    <options customize="never" require-scripts="true" rootVolumeOnly="true" />

    <!-- Welcome message -->
    <welcome file="welcome.html"/>

    <!-- README with installation instructions -->
    <readme file="readme.html"/>

    <!-- Choices outline -->
    <choices-outline>
        <line choice="default">
            <line choice="com.allow2.automate-agent"/>
        </line>
    </choices-outline>

    <choice id="default"/>

    <choice id="com.allow2.automate-agent" visible="false">
        <pkg-ref id="com.allow2.automate-agent"/>
    </choice>

    <pkg-ref id="com.allow2.automate-agent" version="0" onConclusion="none">
        allow2automate-agent-component.pkg
    </pkg-ref>

    <!--
        Note: Configuration validation is handled by the preinstall script,
        which can reliably access files adjacent to the PKG (using $1).

        The preinstall script:
        1. Gets PKG path from $1
        2. Looks for allow2automate-agent-config.json in same directory
        3. Falls back to Downloads, Desktop, /tmp, mounted DMG volumes
        4. Validates JSON structure and required fields
        5. Copies to /tmp/allow2-installer/config.json for postinstall
        6. Exits with error if config not found (blocks installation)

        This approach works regardless of how the installer was launched
        (double-click, command line, from DMG, etc.)
    -->
</installer-gui-script>
